 <html>
    <script src="https://cdn.jsdelivr.net/npm/ruby-head-wasm-wasi@latest/dist/browser.umd.js"></script>
    <script>
      const { DefaultRubyVM } = window["ruby-wasm-wasi"];
      const main = async () => {
        // Fetch and instntiate WebAssembly binary
        const response = await fetch(
          "https://cdn.jsdelivr.net/npm/ruby-head-wasm-wasi@latest/dist/ruby.wasm"
        );
        const buffer = await response.arrayBuffer();
        const module = await WebAssembly.compile(buffer);
        const { vm } = await DefaultRubyVM(module);

        vm.printVersion();
        vm.eval(`
          require "js"
          require "time"
          require "stringio"
          $stdout = StringIO.new
          puts "Ho ho ho!"
          puts "Ruby version: #{RUBY_VERSION}"
          puts "Ruby platform: #{RUBY_PLATFORM}"
          puts "Ruby engine: #{RUBY_ENGINE}"
          puts "Ruby engine version: #{RUBY_ENGINE_VERSION}"
          puts "Ruby description: #{RUBY_DESCRIPTION}"
          puts "Ruby patchlevel: #{RUBY_PATCHLEVEL}"
          puts "Ruby revision: #{RUBY_REVISION}"
          puts "Ruby release date: #{RUBY_RELEASE_DATE}"
          puts "current time is #{Time.now.iso8601}"
          JS::eval("document.body.innerText = #{$stdout.string.inspect}")
        `);
      };

      main();
    </script>
    <body></body>
  </html>
